!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("localforage")):"function"==typeof define&&define.amd?define(["localforage"],t):(e=e||self).i18nextLocalforageBackend=t(e.localforage)}(this,function(e){"use strict";function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(i,!0).forEach(function(t){n(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function r(){return{name:"i18next_res",storeName:"keyvaluepair",description:"",size:4980736,expirationTime:6048e5,version:1,versions:{},driver:[e.INDEXEDDB,e.WEBSQL,e.LOCALSTORAGE]}}e=e&&e.hasOwnProperty("default")?e.default:e;var s=function(){function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n(this,"services",void 0),n(this,"options",void 0),n(this,"storage",void 0),this.init(e,t)}var s,a,c;return s=o,(a=[{key:"init",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.services=t,this.options=i({},r(),{},this.options,{},n),this.storage=e.createInstance(this.options),console.log(this.storage),window.i18forage=this.storage}},{key:"read",value:function(e,t,n){var o=this;console.log("START READ");var i=(new Date).getTime();this.storage.getItem("".concat(e,"-").concat(t)).then(function(t){return console.log("READ OK, calling cb"),t&&t.i18nStamp&&t.i18nStamp+o.options.expirationTime>i&&o.options.versions[e]===t.i18nVersion?(delete t.i18nVersion,delete t.i18nStamp,n(null,t)):n(null,null)})}},{key:"save",value:function(e,t,n){return console.log("START SAVE"),n.i18nStamp=(new Date).getTime(),this.options.versions[e]&&(n.i18nVersion=this.options.versions[e]),this.storage.setItem("".concat(e,"-").concat(t),n).then(function(){console.log("SAVE DONE")})}}])&&t(s.prototype,a),c&&t(s,c),o}();return n(s,"type","backend"),s});
